<div class="c-table-header">
  <otp-filters>
    <otp-filter [name]="'Type' | translate" [values]="['operator', 'government']" prop="observation-type" default="operator" [required]="true"></otp-filter>
    <otp-filter [name]="'Country' | translate" values="countries" prop="country-id" name-attr="name"></otp-filter>
    <otp-filter [name]="'Operator' | translate" values="operators" prop="operator" name-attr="name"></otp-filter>
    <otp-filter [name]="'Report' | translate" values="observation-reports" prop="observation-report" name-attr="title"></otp-filter>
    <otp-filter [name]="'Status' | translate" [values]="statusFilterValues" prop="is-active"></otp-filter>
  </otp-filters>

  <a class="c-button -primary" routerLink="../new">{{'New observation' | translate}}</a>
</div>

<otp-table [caption]="'Observations' | translate" include="observers">
  <otp-table-column [name]="'ID' | translate" prop="id"></otp-table-column>
  <otp-table-column [name]="'Date' | translate" prop="publication-date">
    <ng-template let-value="value" table-cell-template>{{getFormatedDate(value)}}</ng-template>
  </otp-table-column>
  <otp-table-column [name]="'Country' | translate" prop="country.name" [include]="true"></otp-table-column>
  <otp-table-column [name]="'Operator' | translate" prop="operator.name" [include]="true"></otp-table-column>
  <otp-table-column [name]="'Subcategory' | translate" prop="subcategory.name" [include]="true"></otp-table-column>
  <otp-table-column [name]="'Observation' | translate" prop="details"></otp-table-column>
  <otp-table-column [name]="'Severity' | translate" prop="severity.level" [include]="true"></otp-table-column>
  <otp-table-column [name]="'Status' | translate">
    <ng-template let-row="row" table-cell-template>
      <ng-template [ngIf]="row['is-active']">{{'Active' | translate}}</ng-template>
      <ng-template [ngIf]="!row['is-active']">{{'Pending' | translate}}</ng-template>
    </ng-template>
  </otp-table-column>
  <!-- We need the user info for canEdit -->
  <otp-table-column [name]="'Actions' | translate" prop="user" [include]="true">
    <ng-template let-row="row" table-cell-template>
      <ng-template [ngIf]="canEdit(row)">
        <button class="action" (click)="onEdit(row)" [attr.aria-label]="'Edit' | translate"><otp-icon name="#icon-edit"></otp-icon></button>
        <button class="action" (click)="onDelete(row)" [attr.aria-label]="'Delete' | translate"><otp-icon name="#icon-delete"></otp-icon></button>
      </ng-template>
      <ng-template [ngIf]="!canEdit(row)">
        <button class="action" (click)="onEdit(row)" [attr.aria-label]="'Info' | translate"><otp-icon name="#icon-info"></otp-icon></button>
      </ng-template>
    </ng-template>
  </otp-table-column>
</otp-table>
