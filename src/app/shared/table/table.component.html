<div class="overlay" *ngIf="loading"></div>
<otp-loader *ngIf="loading" [attr.class]="rows && rows.length && rows.length > 1 ? '-has-data' : ''"></otp-loader>
<table role="grid" aria-readonly="true" [attr.aria-rowcount]="rowCount">
  <caption>
    <ng-template [ngIf]="caption">{{caption}}</ng-template>
    <ng-template [ngIf]="!caption" i18n="Default caption for the tables">Undefined table</ng-template>
    <ng-template [ngIf]="sortColumn">
      <span i18n="Complementary caption information">, sorted by</span> {{sortColumn.name || sortColumn.prop}}: <span i18n="Sort order of the table" *ngIf="sortOrder === 'asc'">ascendent</span><span i18n="Sort order of the table" *ngIf="sortOrder === 'desc'">descendent</span>
    </ng-template>
  </caption>

  <thead>
    <tr role="row" aria-rowindex="1">
      <th
        *ngFor="let column of columns"
        [attr.class]="(sortColumn === column ? ('-order-' + sortOrder) : '') + (!column.prop ? ' -no-sortable' : '')"
        [attr.aria-sort]="sortColumn === column ? sortOrder : 'none'"
        [tabindex]="sortColumn === column ? 0 : -1"
        role="columnheader"
        (click)="column.prop && sortByColumn(column)"
      >
        {{column.name || column.prop}}
      </th>
    </tr>
  </thead>

  <tbody>
    <tr *ngIf="!rows || !rows.length" class="no-data" role="row">
      <td role="gridcell" [attr.colspan]="columns.length">No data</td>
    </tr>

    <tr *ngFor="let row of renderableRows" role="row" [attr.aria-rowindex]="row.__index__">
      <td *ngFor="let column of columns" role="gridcell" [attr.aria-rowindex]="row.__index__">
        <span class="column-name">{{column.name || column.prop}}</span>
        <ng-template [ngIf]="!column.cellTemplate">{{column.getValue(row)}}</ng-template>
        <ng-template
          [ngIf]="column.cellTemplate"
          [ngTemplateOutlet]="column.cellTemplate"
          [ngOutletContext]="{ value: column.getValue(row), row: row, column: column }"
        >
        </ng-template>
      </td>
    </tr>
  </tbody>

</table>

<span #pageWordTranslation i18n="Table paginator|Page of a table" hidden style="display: none;">Page</span>

<div *ngIf="perPage" class="paginator">
  <button type="button" class="c-button -secondary" [disabled]="!previousPage" (click)="currentPage = previousPage" i18n="Table paginator|Previous page button">Previous</button>
  <ul>
    <li *ngIf="currentPage > firstPage + 1"><button type="button" [attr.aria-label]="pageWord + ' ' + firstPage" (click)="currentPage = firstPage">{{firstPage}}</button></li>
    <li *ngIf="currentPage > firstPage + 2">...</li>
    <li *ngIf="previousPage"><button type="button" [attr.aria-label]="pageWord + ' ' + previousPage" (click)="currentPage = previousPage">{{previousPage}}</button></li>
    <li class="-active"><button type="button" [attr.aria-label]="pageWord + ' ' + currentPage">{{currentPage}}</button></li>
    <li *ngIf="nextPage"><button type="button" [attr.aria-label]="pageWord + ' ' + nextPage" (click)="currentPage = nextPage">{{nextPage}}</button></li>
    <li *ngIf="currentPage < lastPage - 2">...</li>
    <li *ngIf="currentPage < lastPage - 1"><button type="button" [attr.aria-label]="pageWord + ' ' + lastPage" (click)="currentPage = lastPage">{{lastPage}}</button></li>
  </ul>
  <button type="button" class="c-button -secondary" [disabled]="!nextPage" (click)="currentPage = nextPage" i18n="Table paginator|Next page button">Next</button>
</div>
